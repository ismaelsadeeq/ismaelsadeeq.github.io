<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Analyzing Mining Pool Behavior to Address Bitcoin Core’s Double Coinbase Reservation Issue | Abubakar Sadiq Ismail </title> <meta name="author" content="Abubakar Sadiq Ismail"> <meta name="description" content="Analysis of mining pool behavior regarding Bitcoin Core’s double coinbase reservation bug and its impact on block template weights."> <meta name="keywords" content="Abubakar Sadiq Ismail"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/prof_pic.jpeg?4400b4ff2c19f26df087ca783d4c892b"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://abubakarsadiqismail.com/blog/2025/analyzing-mining-pool-behavior-to-address-bitcoin-core-double-coinbase-reservation-issue/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Abubakar</span> Sadiq Ismail </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/books/">bookshelf </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Analyzing Mining Pool Behavior to Address Bitcoin Core’s Double Coinbase Reservation Issue</h1> <p class="post-meta"> Created on January 01, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/bitcoin"> <i class="fa-solid fa-hashtag fa-sm"></i> bitcoin</a>   <a href="/blog/tag/mining"> <i class="fa-solid fa-hashtag fa-sm"></i> mining</a>   <a href="/blog/tag/analysis"> <i class="fa-solid fa-hashtag fa-sm"></i> analysis</a>   <a href="/blog/tag/block-template"> <i class="fa-solid fa-hashtag fa-sm"></i> block-template</a>   ·   <a href="/blog/category/technical"> <i class="fa-solid fa-tag fa-sm"></i> technical</a>   <a href="/blog/category/analysis"> <i class="fa-solid fa-tag fa-sm"></i> analysis</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>In theory, Bitcoin Core’s block-building algorithm reserves <strong>4000 WU</strong> for block header, transaction count and miners’ coinbase transactions.<br> This means it should generate a block template with a weight of <strong>3,996,000 WU</strong>.<br> However, in practice, this is not the case due to an accidental double-reservation bug (<a href="https://github.com/bitcoin/bitcoin/issues/21950" rel="external nofollow noopener" target="_blank">see #21950</a>).<br> As a result, Bitcoin Core generates block templates with a weight of <strong>3,992,000 WU</strong>.</p> <p>There is an ongoing attempt to fix this issue (<a href="https://github.com/bitcoin/bitcoin/pull/31384" rel="external nofollow noopener" target="_blank">see #31384</a>), but there are <a href="https://github.com/bitcoin/bitcoin/pull/31384#pullrequestreview-2489253785" rel="external nofollow noopener" target="_blank">concerns</a> that fixing the issue could lead to some miners generating invalid block templates.<br> If the PR were to be merged, mining pools using the updated Bitcoin Core version must ensure the sum of the coinbase transaction weight and the weight of all additional transactions added to the block template must not exceed <strong>4000 WU</strong>.<br> Otherwise, the block will exceed the consensus limit for the maximum block weight (<strong>4,000,000 WU</strong>) and be invalid.</p> <p>The proposed PR fixes the double reservation issue, increasing the block template size by <strong>4000 WU</strong>, resulting in blocks with a weight of <strong>3,996,000 WU</strong> as expected.</p> <p>Miners or pools needing more than <strong>4000 WU</strong> for their coinbase transactions should configure <code class="language-plaintext highlighter-rouge">bitcoind</code> with a lower <code class="language-plaintext highlighter-rouge">-blockmaxweight</code> option.<br> Example: <code class="language-plaintext highlighter-rouge">-blockmaxweight=3999000</code> frees up an additional <strong>1000 WU</strong>.</p> <p><strong>Blocks Analyzed:</strong> 107,313<br> <strong>Period:</strong> 24th December 2022 to 23rd December 2024</p> <h3 id="methodology">Methodology</h3> <ul> <li>Used <a href="https://github.com/stickies-v/py-bitcoinkernel/" rel="external nofollow noopener" target="_blank">libbitcoinkernel</a> to read blocks from disk.</li> <li>Each block deserialized; <a href="https://github.com/bitcoin-data/mining-pools" rel="external nofollow noopener" target="_blank">bitcoin-data/mining-pools</a> tags used to match the block to a mining pool. Block weight, coinbase transaction, and mining pool info saved to disk.</li> <li>Analysis generated using <a href="https://github.com/ismaelsadeeq/mining-analysis?tab=readme-ov-file#3-generate_resultspy" rel="external nofollow noopener" target="_blank">this script</a>.</li> <li>Charts generated using <a href="https://github.com/ismaelsadeeq/mining-analysis?tab=readme-ov-file#4-graph-generation-scripts" rel="external nofollow noopener" target="_blank">these scripts</a>.</li> <li>More methodology details: <a href="https://github.com/ismaelsadeeq/mining-analysis" rel="external nofollow noopener" target="_blank">GitHub - mining-analysis</a>.</li> </ul> <hr> <h3 id="pools-generating-blocks-with-coinbase-weight--4000-wu">Pools Generating Blocks with Coinbase Weight &gt; 4000 WU</h3> <table> <thead> <tr> <th>Pool Name</th> <th>Average Coinbase weight</th> <th>Lowest Coinbase weight</th> <th>Highest coinbase weight</th> </tr> </thead> <tbody> <tr> <td>Ocean.xyz</td> <td>6994</td> <td>5308 (865820)</td> <td>9272 (863471)</td> </tr> <tr> <td>Unknown pool</td> <td>7432</td> <td>7000 (824116)</td> <td>7864 (785117)</td> </tr> </tbody> </table> <div class="row mt-4"> <div class="col-md-9"> <figure> <img class="img-fluid rounded z-depth-1" src="/assets/img/mining-analysis/fig1.png" alt="Large Coinbase Transaction Weights"> <figcaption class="mt-2 text-muted"> Distribution of coinbase transaction weights for pools generating blocks with coinbase weights &gt; 4000 WU. </figcaption> </figure> </div> </div> <hr> <h3 id="remaining-mining-pools-coinbase-stats">Remaining Mining Pools Coinbase Stats</h3> <table> <thead> <tr> <th>Pool Name</th> <th>Average Coinbase Weight</th> <th>Lowest Coinbase Weight</th> <th>Highest Coinbase Weight</th> </tr> </thead> <tbody> <tr> <td>ViaBTC</td> <td>1,128</td> <td>864 (778363)</td> <td>1,284 (868424)</td> </tr> <tr> <td>Foundry USA</td> <td>834</td> <td>748 (833764)</td> <td>1,192 (868391)</td> </tr> <tr> <td>F2Pool</td> <td>1,610</td> <td>1,176 (787112)</td> <td>1,832 (868388)</td> </tr> <tr> <td>AntPool</td> <td>1,357</td> <td>732 (814783)</td> <td>1,612 (875136)</td> </tr> <tr> <td>Binance Pool</td> <td>1,151</td> <td>684 (789485)</td> <td>1,480 (810101)</td> </tr> <tr> <td>SpiderPool</td> <td>997</td> <td>704 (817123)</td> <td>1,296 (863176)</td> </tr> <tr> <td>Braiins Pool</td> <td>1,056</td> <td>684 (853433)</td> <td>1,232 (785389)</td> </tr> <tr> <td>MARA Pool</td> <td>815</td> <td>720 (800883)</td> <td>1,016 (833308)</td> </tr> <tr> <td>SecPool</td> <td>1,371</td> <td>1,088 (808120)</td> <td>1,460 (871380)</td> </tr> <tr> <td>Poolin</td> <td>1,110</td> <td>728 (852695)</td> <td>1,336 (795979)</td> </tr> <tr> <td>Luxor</td> <td>1,237</td> <td>780 (770527)</td> <td>1,480 (868404)</td> </tr> <tr> <td>BTC.com</td> <td>1,205</td> <td>740 (796334)</td> <td>1,476 (811469)</td> </tr> <tr> <td>Pega Pool</td> <td>688</td> <td>688 (800892)</td> <td>688 (800892)</td> </tr> <tr> <td>Ultimus Pool</td> <td>1,209</td> <td>1,056 (853449)</td> <td>1,444 (844214)</td> </tr> <tr> <td>EMCDPool</td> <td>1,082</td> <td>1,080 (804771)</td> <td>1,304 (795962)</td> </tr> <tr> <td>SBI Crypto</td> <td>716</td> <td>716 (833247)</td> <td>716 (833247)</td> </tr> <tr> <td>NiceHash</td> <td>786</td> <td>780 (804872)</td> <td>828 (870207)</td> </tr> <tr> <td>Titan</td> <td>696</td> <td>696 (770484)</td> <td>696 (770484)</td> </tr> <tr> <td>WhitePool</td> <td>887</td> <td>676 (820630)</td> <td>1,304 (865060)</td> </tr> <tr> <td>KuCoin Pool</td> <td>1,095</td> <td>1,092 (777136)</td> <td>1,316 (796122)</td> </tr> <tr> <td>CleanIncentive</td> <td>728</td> <td>728 (819134)</td> <td>728 (819134)</td> </tr> <tr> <td>1THash</td> <td>1,084</td> <td>1,084 (837937)</td> <td>1,088 (864350)</td> </tr> <tr> <td>EclipseMC</td> <td>860</td> <td>860 (858559)</td> <td>860 (858559)</td> </tr> <tr> <td>Terra Pool</td> <td>844</td> <td>844 (780190)</td> <td>844 (780190)</td> </tr> <tr> <td>CKPool</td> <td>856</td> <td>856 (863890)</td> <td>856 (863890)</td> </tr> </tbody> </table> <div class="row mt-4"> <div class="col-md-9"> <figure> <img class="img-fluid rounded z-depth-1" src="/assets/img/mining-analysis/fig2.png" alt="Line Chart of Coinbase Transaction Weights"> <figcaption class="mt-2 text-muted"> Average, minimum, and maximum coinbase transaction weights for various mining pools. </figcaption> </figure> </div> </div> <hr> <h3 id="pools-with-blocks--3996000-wu">Pools with Blocks (&gt; 3,996,000 WU)</h3> <table> <thead> <tr> <th>Pool Name</th> <th>Average Block Weight</th> <th>Lowest Block Weight</th> <th>Highest Block Weight</th> </tr> </thead> <tbody> <tr> <td>F2Pool</td> <td>3,997,857</td> <td>3,994,044 (828959)</td> <td>3,998,554 (779729)</td> </tr> </tbody> </table> <h3 id="pools-with-blocks--3996000-wu-1">Pools with Blocks (&lt; 3,996,000 WU)</h3> <table> <thead> <tr> <th>Pool Name</th> <th>Average Block Weight</th> <th>Lowest Block Weight</th> <th>Highest Block Weight</th> </tr> </thead> <tbody> <tr> <td>Foundry USA</td> <td>3,993,030</td> <td>3,992,749 (813879)</td> <td>3,993,523 (874770)</td> </tr> <tr> <td>Binance Pool</td> <td>3,993,348</td> <td>3,992,753 (784937)</td> <td>3,993,768 (846996)</td> </tr> <tr> <td>MARA Pool</td> <td>3,993,017</td> <td>3,992,721 (802653)</td> <td>3,994,944 (859968)</td> </tr> <tr> <td>Luxor</td> <td>3,993,434</td> <td>3,992,782 (768718)</td> <td>3,993,811 (841510)</td> </tr> <tr> <td>AntPool</td> <td>3,993,554</td> <td>3,992,868 (814783)</td> <td>3,993,918 (873367)</td> </tr> <tr> <td>ViaBTC</td> <td>3,993,324</td> <td>3,992,881 (782955)</td> <td>3,993,612 (872513)</td> </tr> <tr> <td>Poolin</td> <td>3,993,308</td> <td>3,992,987 (855538)</td> <td>3,993,613 (795979)</td> </tr> <tr> <td>Braiins Pool</td> <td>3,993,251</td> <td>3,992,695 (853433)</td> <td>3,993,416 (853776)</td> </tr> <tr> <td>SBI Crypto</td> <td>3,992,911</td> <td>3,992,717 (796840)</td> <td>3,993,047 (834797)</td> </tr> <tr> <td>Ultimus Pool</td> <td>3,993,407</td> <td>3,993,076 (852748)</td> <td>3,993,768 (842345)</td> </tr> <tr> <td>BTC.com</td> <td>3,993,399</td> <td>3,992,745 (796409)</td> <td>3,993,781 (806063)</td> </tr> <tr> <td>SpiderPool</td> <td>3,993,190</td> <td>3,992,912 (856599)</td> <td>3,993,616 (864899)</td> </tr> <tr> <td>WhitePool</td> <td>3,993,072</td> <td>3,992,677 (825268)</td> <td>3,993,631 (872281)</td> </tr> <tr> <td>Ocean.xyz</td> <td>3,988,137</td> <td>3,986,489 (865820)</td> <td>3,990,301 (863471)</td> </tr> <tr> <td>EMCDPool</td> <td>3,993,273</td> <td>3,993,081 (781934)</td> <td>3,993,428 (796046)</td> </tr> <tr> <td>Pega Pool</td> <td>3,992,894</td> <td>3,992,690 (783729)</td> <td>3,993,018 (781576)</td> </tr> <tr> <td>Titan</td> <td>3,992,974</td> <td>3,992,926 (768641)</td> <td>3,993,020 (769939)</td> </tr> <tr> <td>KuCoin Pool</td> <td>3,993,282</td> <td>3,993,101 (781030)</td> <td>3,993,504 (796188)</td> </tr> <tr> <td>Terra Pool</td> <td>3,993,032</td> <td>3,992,863 (776927)</td> <td>3,993,172 (780396)</td> </tr> <tr> <td>CleanIncentive</td> <td>3,992,946</td> <td>3,992,748 (823029)</td> <td>3,993,038 (822604)</td> </tr> <tr> <td>1THash</td> <td>3,993,276</td> <td>3,993,085 (837937)</td> <td>3,993,412 (814830)</td> </tr> <tr> <td>NiceHash</td> <td>3,992,987</td> <td>3,992,782 (789503)</td> <td>3,993,148 (785085)</td> </tr> <tr> <td>CKPool</td> <td>3,993,102</td> <td>3,992,897 (863890)</td> <td>3,993,181 (822636)</td> </tr> </tbody> </table> <div class="row mt-4"> <div class="col-md-9"> <figure> <img class="img-fluid rounded z-depth-1" src="/assets/img/mining-analysis/fig3.png" alt="Block Weights for Pools"> <figcaption class="mt-2 text-muted"> Average, minimum, and maximum block weights for various mining pools. </figcaption> </figure> </div> </div> <hr> <h3 id="key-observations">Key Observations</h3> <ul> <li>Most mining pools adhere to Bitcoin Core’s default setup, keeping coinbase transaction weights well below <strong>4000 WU</strong>. Two pools stand out: <ul> <li> <strong>Ocean.xyz</strong>: Avg coinbase <strong>6,994 WU</strong>, min <strong>5,308 WU</strong>, max <strong>9,272 WU</strong>, avg block weight <strong>3,986,489 WU</strong>. Likely uses reduced <code class="language-plaintext highlighter-rouge">-blockmaxweight</code>.</li> <li> <strong>Unknown Pool</strong>: Avg coinbase <strong>7,432 WU</strong>, max <strong>7,864 WU</strong>, very low block weight—unusual.</li> </ul> </li> <li> <strong>F2Pool</strong>: Avg block <strong>3,997,857 WU</strong>, e.g., block <strong>779729</strong> reached <strong>3,998,554 WU</strong> with coinbase <strong>1,588 WU</strong>, showing efficient block use.</li> <li>Majority of pools (Foundry USA, Binance Pool, AntPool) produce blocks ~<strong>3,993,000 WU</strong>, showing underutilization due to double-reservation bug.</li> <li>Small increase in block weights accounted for by block headers (<a href="https://delvingbitcoin.org/t/analyzing-mining-pool-behavior-to-address-bitcoin-cores-double-coinbase-reservation-issue/1351/4?u=ismaelsadeeq" rel="external nofollow noopener" target="_blank">see @0xB10C</a>).</li> </ul> <p>Fixing double-reservation increases block templates to <strong>3,996,000 WU</strong>, allowing full block weight utilization while preserving <strong>4000 WU</strong> for coinbase and other additions.</p> <p>Miners needing extra space (like Ocean.xyz) can set <code class="language-plaintext highlighter-rouge">-blockmaxweight=3999000</code> to free <strong>1000 WU</strong> for larger coinbase transactions, ensuring consensus compliance.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Abubakar Sadiq Ismail. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> </body> </html>